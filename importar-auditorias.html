<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importar Auditor칤as - Sistema de Evaluaci칩n</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>游늵 Sistema de Evaluaci칩n</h1>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Dashboard</a></li>
                <li><a href="detalle-auditorias.html">Detalle de Auditor칤as</a></li>
                <li><a href="importar-auditorias.html" class="active">Importar Auditor칤as</a></li>
                <li><a href="detalle-feedbacks.html">Detalle de Feedbacks</a></li>
                <li><a href="analisis-avanzado.html">An치lisis Avanzado</a></li>
                <li><a href="agentes.html">Gesti칩n de Agentes</a></li>
                <li><a href="sj-pendientes.html">SJ Pendientes</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <header class="page-header">
            <h2>Importar Auditor칤as desde Excel / CSV</h2>
            <a href="detalle-auditorias.html" class="btn btn-secondary">Volver a Detalle de Auditor칤as</a>
        </header>

        <div class="form-card">
            <p class="info-text" style="margin-bottom: 1rem;">
                Sube un archivo Excel (.xlsx, .xls), CSV o PDF (tabla con las mismas columnas) con las columnas: <strong>Fecha</strong>, <strong>Criticidad</strong>, 
                <strong>쯈ui칠n analiz칩 el caso?</strong>, <strong>Product</strong>, <strong>Agent</strong>, <strong>Xtronaut error</strong>, 
                <strong>tNPS</strong>, <strong>actor_affiliation</strong>, <strong>Customer_ID</strong>, <strong>Person View</strong>. 
                Todas las filas se asignar치n al agente que selecciones abajo.
            </p>
            <div class="form-row">
                <div class="form-group">
                    <label for="agentId">Agente al que pertenecen estas auditor칤as *</label>
                    <select id="agentId" required>
                        <option value="">Seleccionar agente...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Archivo a importar *</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: center;">
                        <input type="file" id="fileInput" accept=".csv,.xlsx,.xls,.pdf,application/pdf,text/csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" style="max-width: 100%;">
                        <span style="color: var(--text-muted); font-size: 0.9rem;">CSV, Excel (.xlsx, .xls) o <strong>PDF (.pdf)</strong></span>
                    </div>
                    <small class="form-hint">Si no ves PDF en el selector, elige "Todos los archivos" y selecciona tu .pdf</small>
                </div>
            </div>
            <div id="previewSection" style="display: none;">
                <h3 class="section-title">Vista previa (<span id="previewCount">0</span> filas)</h3>
                <div class="table-container" style="max-height: 300px;">
                    <table class="data-table">
                        <thead id="previewThead"></thead>
                        <tbody id="previewTbody"></tbody>
                    </table>
                </div>
                <div style="margin-top: 1rem;">
                    <button type="button" id="btnImport" class="btn btn-primary">Importar todas</button>
                    <span id="importStatus" style="margin-left: 1rem;"></span>
                </div>
            </div>
            <div id="errorMessage" class="error-message" style="display: none;"></div>
            <div id="successMessage" class="success-message" style="display: none;"></div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
    <script src="supabase-config.js"></script>
    <script src="app.js"></script>
    <script src="importar-auditorias.js?v=pdf2"></script>
</body>
</html>
